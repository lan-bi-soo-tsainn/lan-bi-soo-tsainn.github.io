<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>巷弄</title>
    <link rel="stylesheet" href="css/detail.css">
    <script async src="https://unpkg.com/es-module-shims/dist/es-module-shims.js"></script>

    <script type="importmap">
	{
		"imports": {
			"three": "https://unpkg.com/three/build/three.module.js"
		}
	}
</script>
</head>

<body>
    <div class="music-block">
        <div class="arrow-btn">
            <img src="/assets/arrow-btn.png" />
        </div>
        <img class="detail-street-img" src="/assets/street/detail_street.png" />
        <div class="angle"></div>
        <audio id="music" controls src="/assets/street/street.mp3"></audio>
    </div>
    <article>
        <section class="video-block">
            <img class="video-block-background" src="/assets/background.png"
                srcset="/assets/background.png 500w, /assets/background.png 1000w, /assets/background.png 1500w" />
            <div class="video-block-intro">
                <div class="video-block-intro-content">
                    <h1>巷弄</h1>
                    <p>THE HIDDEN<br />WARMTH<br />AROUND THE <br>ALLEY CORNERS.</p>
                </div>
                <div class="video-block-intro-3d">
                </div>
            </div>
            <div class="video-block-video-block">
                <video autoplay muted loop playsinline id="indexVideo">
                    <source src="/assets/street/street_intro.mp4" type="video/mp4">
                </video>
            </div>
        </section>
        <section class="article-block">
            <div class="article-block-word">
                <p>巷弄，一份無法言語的人情溫暖，<br>每一個轉角都是一段故事的開始。</p>
                <p>街坊鄰里間流淌著深厚的細膩情感。<br>彷彿一本記載著人生點滴的書，<br>每個居民皆是共同譜寫出人情味的重要角色。</p>
                <p>巷弄是一本筆記本<br>提醒一對老夫妻明天明年往後的每一天早晨都要記得澆花，<br>防止孩子們忘紀了最後一場的紅綠燈鬼是誰。</p>
                <p>人情的故事就像是巷弄的微風，<br>悄悄地流轉，<br>縷縷串連著愛與連結。</p>
            </div>
            <div class="article-block-word en">
                <p>The alleyways, a silent warmth of human connection,Every corner marks<br> the beginning of a
                    story.<br>
                    Among neighbors, profound and delicate emotions flow.As if pages<br>chronicling life's moments,Each
                    resident plays a vital role in composing the essence of human kindness.<br>
                    The alleyways serve as a notebook,Reminding an elderly couple to water <br>their plants every
                    morning for the days to come,Ensuring children <br>remember who won the final game of red light,
                    green light.<br>
                    Tales of human connection are like the gentle breeze in the alley,Quietly
                    <br>circulating,Intertwining threads of love and connection.</p>
            </div>
        </section>
        <div class="top-btn" data-action="gotop">
            <img src="/assets/btn.png" />
        </div>
    </article>

</body>
<script type="module" src="/js/3d_street.js"></script>
<script>
    var video = document.getElementById("indexVideo");
    function myFunction() {
        if (video.paused) {
            video.play();
        }
    }

    let requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;

    document.addEventListener('DOMContentLoaded', function () {
        const goTopButton = document.querySelector('[data-action="gotop"]');
        const windowViewPortHeight = window.innerHeight; // browser viewport height
        let isRequestingAnimationFrame = false;

        if (!goTopButton) {
            return;
        }

        goTopButton.addEventListener('click', function () {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    });

    document.addEventListener('DOMContentLoaded', function () {
        var aduioButton = document.querySelector('.arrow-btn');
        var music = document.getElementById("music");
        aduioButton.addEventListener('click', function () {
            if (aduioButton.style.transform == 'rotate(90deg)') {
                aduioButton.style.transform = 'rotate(0deg)';
                music.style.visibility = 'hidden';
                music.pause();
            } else {
                aduioButton.style.transform = 'rotate(90deg)';
                music.style.visibility = 'visible';

            }


        });
    });

    var startX = 0; //触摸开始时的位置
    var endX = 0; //触摸结束时的位置
    var startTime = 0; //触摸开始的时间
    var endTime = 0; //触摸结束的时间

    //获取触摸开始时的位置和时间
    video.addEventListener('touchstart', function (event) {
        startX = event.touches[0].pageX;
        startTime = new Date().getTime();
    }, false);

    //获取触摸过程中的实时位置
    video.addEventListener('touchmove', function (event) {
        endX = event.touches[0].pageX;
    }, false);

    //当触摸结束时，判断是否进行切换操作
    video.addEventListener('touchend', function (event) {
        var distance = endX - startX; //触摸移动的距离
        endTime = new Date().getTime(); //获取触摸结束的时间
        var duration = endTime - startTime; //触摸持续的时间
        var speed = Math.abs(distance) / duration; //触摸的速度

        if (distance > (window.innerWidth/3) && speed > 0.2) { //向右滑动的条件
            //执行向右滑动的操作
            window.location.href = "/breakfast.html";
        } else if (distance < (window.innerWidth/3) && speed > 0.2) { //向左滑动的条件
            //执行向左滑动的操作
            window.location.href = "/market.html";
        }
    }, false);
</script>

</html>